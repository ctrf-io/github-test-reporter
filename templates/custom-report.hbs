# Create a Custom Summary!

You can effortlessly generate custom test summaries and PR comments using your CTRF report, Handlebars and Markdown. 

## Example: Generating a Summary

Let's start with the basics, a summary table that gives an overview of your test ctrf (you might have seen this one somewhere!). This table is straightforward yet powerful, helping you quickly communicate the state of your tests:

| **Tests üìù** | **Passed ‚úÖ** | **Failed ‚ùå** | **Skipped ‚è≠Ô∏è** | **Pending ‚è≥** | **Other ‚ùì** | **Flaky üçÇ** | **Duration ‚è±Ô∏è** |
| --- | --- | --- | --- | --- | --- | --- | --- |
| {{ctrf.summary.tests}} | {{ctrf.summary.passed}} | {{ctrf.summary.failed}} | {{ctrf.summary.skipped}} | {{ctrf.summary.pending}} | {{ctrf.summary.other}} | {{countFlaky ctrf.tests}} | {{formatDuration ctrf.summary.start ctrf.summary.stop}} |

This table is generated by referencing various properties from your CTRF report, making it easy to create detailed and customized summaries.

In addition, you can leverage custom methods like `countFlaky` and `formatDuration` to enhance your summary:

**Count of flaky tests**: {{countFlaky ctrf.tests}}
**Duration of execution**: {{formatDuration ctrf.summary.start ctrf.summary.stop}}

Remember, you're not just writing markdown‚Äîyou're writing markdown enhanced with Handlebars, which means you can take full advantage of markdown's features while adding dynamic content.

## Example: Iterating Over the Tests Array

Next, let's focus on generating a report specifically for failed tests. To do this, we'll iterate through the CTRF tests array and filter out the failed tests:

| **Name** | **Status** | **Failure Message** |
| --- | --- | --- |
{{#each ctrf.tests}}
  {{#if (eq status "failed")}}
  | {{name}} | {{status}} ‚ùå | {{#if message}}{{message}}{{else}}No failure message{{/if}} |
  {{/if}}
{{/each}}

You might have noticed, this one is using a helper called `eq`. You can use this for property comparisons directly within your template logic.

## HTML

If raw markdown isn't quite working for you, GitHub also renders some HTML.

Here is the same failed table in HTML:

<table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Status</th>
        <th>Failure Message</th>
      </tr>
    </thead>
    <tbody>
      {{#each ctrf.tests}}
        {{#if (eq status "failed")}}
        <tr>
          <td>{{name}}</td>
          <td>{{status}}  ‚ùå</td>
          <td>{{#if message}}{{stripAnsi message}}{{else}}No failure message{{/if}}</td>
        </tr>
        {{/if}}
      {{/each}}
    </tbody>
  </table>

Notice the use of the stripAnsi method, as some error messages contain ANSI.

## Adding Extra Markdown Elements

You can further enrich your summaries by tagging collaborators, adding tasks, and linking to important resources. Here's how:

### Tag a collaborator:

You might want to notify someone specific, like @Ma11hewThomas.

### You can add tasks!

- [x] Passed all unit tests
- [ ] Review code quality
- [ ] Update documentation

### Include useful links:

[GitHub Actions Documentation](https://docs.github.com/en/actions)

### Adding Collapsible Sections

If you have extensive details that might clutter your summary, you can use collapsible sections to hide and reveal information as needed:

<details>
  <summary>See detailed test results</summary>

  <br>

  | **Name** | **Status** | **Failure Message** |
  | --- | --- | --- |
  {{#each ctrf.tests}}
  | {{name}} | {{status}} | {{#if message}}{{stripAnsi message}}{{else}}No failure message{{/if}} |
  {{/each}}
</details>


### GitHub properties

There are various GitHub properties you can tap into!

> **Note:** These properties are accessed via the `github` object in your template, for example `{{github.repoName}}`, `{{github.repository.cloneUrl}}`, etc.  
> Mirrors (e.g., `eventName` vs. `event_name`) are shown for completeness; many workflows will only use one or the other.

---

## Root Context

Accessed as `{{github.<property>}}`. For example, `{{github.action}}`.

- **action**: `{{github.action}}`  
- **action_name**: `{{github.action_name}}`  
- **actor**: `{{github.actor}}`  
- **actor_name**: `{{github.actor_name}}`  
- **eventName**: `{{github.eventName}}`  
- **event_name**: `{{github.event_name}}`  
- **sha**: `{{github.sha}}`  
- **ref**: `{{github.ref}}`  
- **workflow**: `{{github.workflow}}`  
- **job**: `{{github.job}}`  
- **job_id**: `{{github.job_id}}`  
- **runNumber**: `{{github.runNumber}}`  
- **run_number**: `{{github.run_number}}`  
- **runId**: `{{github.runId}}`  
- **run_id**: `{{github.run_id}}`  
- **apiUrl**: `{{github.apiUrl}}`  
- **api_url**: `{{github.api_url}}`  
- **serverUrl**: `{{github.serverUrl}}`  
- **server_url**: `{{github.server_url}}`  
- **graphqlUrl**: `{{github.graphqlUrl}}`  
- **graphql_url**: `{{github.graphql_url}}`  
- **repoName**: `{{github.repoName}}`  
- **build_url**: `{{github.build_url}}`  
- **jobName**: `{{github.jobName}}`  
- **workflowId**: `{{github.workflowId}}`  
- **workflowName**: `{{github.workflowName}}`  
- **actorName**: `{{github.actorName}}`  
- **pullRequestNumber**: `{{github.pullRequestNumber}}`  
- **baseURL**: `{{github.baseURL}}`  

---

## Additional Context

Accessed as `{{github.additional.<property>}}`. For example, `{{github.additional.buildUrl}}`.

- **buildUrl**: `{{github.additional.buildUrl}}`  
- **build_url**: `{{github.additional.build_url}}`  
- **branchName**: `{{github.additional.branchName}}`  

---

## Repository Context

Accessed as `{{github.repository.<property>}}`. For example, `{{github.repository.cloneUrl}}`.

- **cloneUrl** / **clone_url**: `{{github.repository.cloneUrl}}` / `{{github.repository.clone_url}}`  
- **createdAt** / **created_at**: `{{github.repository.createdAt}}` / `{{github.repository.created_at}}`  
- **defaultBranch** / **default_branch**: `{{github.repository.defaultBranch}}` / `{{github.repository.default_branch}}`  
- **description**: `{{github.repository.description}}`  
- **fullName** / **full_name**: `{{github.repository.fullName}}` / `{{github.repository.full_name}}`  
- **htmlUrl** / **html_url**: `{{github.repository.htmlUrl}}` / `{{github.repository.html_url}}`  
- **language**: `{{github.repository.language}}`  
- **licenseName** / **license_name**: `{{github.repository.licenseName}}` / `{{github.repository.license_name}}`  
- **name**: `{{github.repository.name}}`  
- **openIssuesCount** / **open_issues_count**: `{{github.repository.openIssuesCount}}` / `{{github.repository.open_issues_count}}`  
- **size**: `{{github.repository.size}}`  
- **stargazersCount** / **stargazers_count**: `{{github.repository.stargazersCount}}` / `{{github.repository.stargazers_count}}`  
- **allowForking** / **allow_forking**: `{{github.repository.allowForking}}` / `{{github.repository.allow_forking}}`  
- **compareUrl** / **compare_url**: `{{github.repository.compareUrl}}` / `{{github.repository.compare_url}}`  
- **contributorsUrl** / **contributors_url**: `{{github.repository.contributorsUrl}}` / `{{github.repository.contributors_url}}`  
- **deploymentsUrl** / **deployments_url**: `{{github.repository.deploymentsUrl}}` / `{{github.repository.deployments_url}}`  
- **downloadsUrl** / **downloads_url**: `{{github.repository.downloadsUrl}}` / `{{github.repository.downloads_url}}`  
- **eventsUrl** / **events_url**: `{{github.repository.eventsUrl}}` / `{{github.repository.events_url}}`  
- **forksUrl** / **forks_url**: `{{github.repository.forksUrl}}` / `{{github.repository.forks_url}}`  
- **sshUrl** / **ssh_url**: `{{github.repository.sshUrl}}` / `{{github.repository.ssh_url}}`  
- **stargazersUrl** / **stargazers_url**: `{{github.repository.stargazersUrl}}` / `{{github.repository.stargazers_url}}`  
- **statusesUrl** / **statuses_url**: `{{github.repository.statusesUrl}}` / `{{github.repository.statuses_url}}`  
- **subscriptionUrl** / **subscription_url**: `{{github.repository.subscriptionUrl}}` / `{{github.repository.subscription_url}}`  
- **tagsUrl** / **tags_url**: `{{github.repository.tagsUrl}}` / `{{github.repository.tags_url}}`  
- **teamsUrl** / **teams_url**: `{{github.repository.teamsUrl}}` / `{{github.repository.teams_url}}`  

---

## Pull Request Context

Accessed as `{{github.pull_request.<property>}}`. For example, `{{github.pull_request.id}}`.

- **additions**: `{{github.pull_request.additions}}`  
- **assignee**: `{{github.pull_request.assignee}}`  
- **assignees**: `{{github.pull_request.assignees}}`  
- **authorAssociation** / **author_association**: `{{github.pull_request.authorAssociation}}` / `{{github.pull_request.author_association}}`  
- **autoMerge** / **auto_merge**: `{{github.pull_request.autoMerge}}` / `{{github.pull_request.auto_merge}}`  
- **pushedAt** / **pushed_at**: `{{github.pull_request.pushedAt}}` / `{{github.pull_request.pushed_at}}`  
- **body**: `{{github.pull_request.body}}`  
- **changedFiles** / **changed_files**: `{{github.pull_request.changedFiles}}` / `{{github.pull_request.changed_files}}`  
- **closedAt** / **closed_at**: `{{github.pull_request.closedAt}}` / `{{github.pull_request.closed_at}}`  
- **comments**: `{{github.pull_request.comments}}`  
- **createdAt** / **created_at**: `{{github.pull_request.createdAt}}` / `{{github.pull_request.created_at}}`  
- **deletions**: `{{github.pull_request.deletions}}`  
- **diffUrl** / **diff_url**: `{{github.pull_request.diffUrl}}` / `{{github.pull_request.diff_url}}`  
- **draft**: `{{github.pull_request.draft}}`  
- **htmlUrl** / **html_url**: `{{github.pull_request.htmlUrl}}` / `{{github.pull_request.html_url}}`  
- **id**: `{{github.pull_request.id}}`  
- **labels**: `{{github.pull_request.labels}}`  
- **number**: `{{github.pull_request.number}}`  
- **patchUrl** / **patch_url**: `{{github.pull_request.patchUrl}}` / `{{github.pull_request.patch_url}}`  
- **rebaseable**: `{{github.pull_request.rebaseable}}`  
- **requestedReviewers** / **requested_reviewers**: `{{github.pull_request.requestedReviewers}}` / `{{github.pull_request.requested_reviewers}}`  
- **requestedTeams** / **requested_teams**: `{{github.pull_request.requestedTeams}}` / `{{github.pull_request.requested_teams}}`  
- **reviewComments** / **review_comments**: `{{github.pull_request.reviewComments}}` / `{{github.pull_request.review_comments}}`  
- **state**: `{{github.pull_request.state}}`  
- **title**: `{{github.pull_request.title}}`  

---

## Sender Context

Accessed as `{{github.sender.<property>}}`. For example, `{{github.sender.login}}`.

- **login**: `{{github.sender.login}}`  
- **id**: `{{github.sender.id}}`  
- **nodeId** / **node_id**: `{{github.sender.nodeId}}` / `{{github.sender.node_id}}`  
- **avatarUrl** / **avatar_url**: `{{github.sender.avatarUrl}}` / `{{github.sender.avatar_url}}`  
- **gravatarId** / **gravatar_id**: `{{github.sender.gravatarId}}` / `{{github.sender.gravatar_id}}`  
- **htmlUrl** / **html_url**: `{{github.sender.htmlUrl}}` / `{{github.sender.html_url}}`  
- **type**: `{{github.sender.type}}`  
- **siteAdmin** / **site_admin**: `{{github.sender.siteAdmin}}` / `{{github.sender.site_admin}}`  

---


